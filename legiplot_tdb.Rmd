---
title: "Legiplot : une étude quantitative des codes législatifs"
subtitle: "https://github.com/juliengossa/legiplot"
author: 
  - Yang Yang, email \newline
  - Julien Gossa, gossa@unistra.fr \newline
  - Université de Strasbourg
date: Juin 2021
output: 
  beamer_presentation:
    theme: "Madrid"
    toc: true
fontsize: 8pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(dplyr.summarise.inform = FALSE)

library(tidyverse)
library(ggthemes)
library(cowplot)

source("legiplot_fun_load.R")
source("legiplot_fun_tree.R")
source("legiplot_fun_evol.R")
source("legiplot_fun_diff.R")

code.exemple <- "code de l'éducation"
```

```{r setup.load, include=FALSE, cache=TRUE}
legiplot_load_tree()
legiplot_load_evol()
legiplot_load_diff()
```

## Introduction

### Présentation du projet

Legiplot vise à évaluer le rythme des réformes par la quantification des 
modification des codes législatifs. 

Les données de ces codes sont extraites des projets suivants :
-   [Légifrance](https://www.legifrance.gouv.fr/) : le portail officiel bien connu ;
-   [Archéo Lex](https://archeo-lex.fr/) : un projet indépendant qui consolide les 
    textes de Légifrance dans des dépôts GIT.
    
De ces données, nous extrayons différents indicateurs et visualisations 
qui sont présentés dans la suite.


### Structure

::: columns

:::: column
Cette représentation permet d'apprécier, dans l'espace, le volume relatif de 
différentes partie des codes.

- Les structures des codes sont présentées en arbre. 
- La représentation se limite à la partie législative.
- Chaque nœud représente une section.
- La couleur est celle de la sous-partie ou du Livre.
- La taille représente le nombre d'articles.
::::

:::: column
```{r exemple.tree, fig.width=10, fig.height=10, out.width="100%" }
legiplot_plot_tree(code.exemple)
```
::::

:::


### Indicateurs

::: columns

:::: column

Cette représentation permet d'apprécier l'évolution dans le temps des volumes des codes,
selon plusieurs manières de les mesurer.

- Trois indicateurs primaires sont présentés :

  - Nombre d'articles
  - Nombre d'alinéas (les énumerations sont comptées comme alinéas)
  - Nombre de mots

- Trois indicateurs secondaires sont présentés :

  - Nombre d'alinéas par articles
  - Nombre de mots par articles
  - Nombre de mots par alinéas

- Pour être comparables, tous les indicateurs sont normalisés en valeur 100 pour
le début de la période.
::::

:::: column
```{r exemple.ind, fig.width=6, fig.height=4, out.width="100%" }
legiplot_indcode_plot(code.exemple)
```
::::

:::




### Evolution des volumes des Livres

::: columns

:::: column

Cette représentation permet d'apprécier l'évolution dans le temps des volumes 
des Livres, en fonction des parties, en terme de nombre d'articles. 

Elle est particulièrement utile pour détecter les codifications progressives.

- Les couleurs représentent les Livres.
::::

:::: column
```{r exemple.vol, fig.width=6, fig.height=4, out.width="100%" }
legiplot_vol_code(code.exemple)
```
::::

:::



### Proportion des modifications

::: columns

:::: column

Cette représentation permet d'apprécier l'évolution des articles qui composent un code.

Elle est particulièrement utile pour vérifier ce qu'il reste du code original au 
fil des transformations.

- Les couleurs représentent le nombre d'articles ajoutés, modifiés ou supprimés.
- La première réprésentation est en nombre d'articles.
- La seconde représentation est en proportion des articles.
- En raison d'erreurs en cours de correction dans Légifrance, certaines 

::::

:::: column
```{r exemple.modfis, fig.width=6, fig.height=8, out.width="100%" }
plot_grid(ncol=1,
 legiplot_modifs_codes_plot(uncode=code.exemple,start="0001-01-01",legend.pos="none"),
 legiplot_modifs_codes_plot(pos="fill",uncode=code.exemple,start="0001-01-01",legend.pos="none")
)
```
::::

:::

## Codes


```{r tdb}

tdb <- function(code) {
  plot_grid(ncol=2,
     plot_grid(ncol=1, rel_heights = c(2.5,1),
       legiplot_plot_tree(code),
       plot_grid(ncol=2,
         legiplot_modifs_codes_plot(uncode=code,start="0001-01-01",legend.pos="none"),
         legiplot_modifs_codes_plot(pos="fill",uncode=code,start="0001-01-01",legend.pos="none")
        )
     ),
     plot_grid(ncol=1, align = "v", axis="lr",
       legiplot_indcode_plot(uncode=code),
       legiplot_vol_code(uncode=code),
       legiplot_modifs_annees_plot(uncode=code,start="0001-01-01")
    )
  )
}

#tdb("code de l'éducation")

```


```{r all, results='asis', fig.width=18,fig.height=12, warning=FALSE, cache=TRUE}
for(code in levels(lp_modifs_articles_sum$code)) {
#  code <- "code de l'éducation"

  cat("### ",code,"\n\n")
  
  print(tdb(code))
  
  cat("\n\n")
}
```
