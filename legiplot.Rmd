---
title: "Legiplot"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(kableExtra)
library(ggthemes)
```

```{r load}
legiplot <- read.csv("all_codes_fulltext.csv") %>%
  mutate(code = str_replace_all(code,'_',' ')) %>%
  mutate(année = as.numeric(str_sub(date,1,4)))
```

## Données 

```{r data}
legiplot %>%
  group_by(code) %>%
  summarise(
    nb_modifs = n(),
    début = min(date),
    fin = max(date),
    parties = n_distinct(partie),
    sous_parties = n_distinct(sous_partie),
    livres = n_distinct(livre),
    titres = n_distinct(titre),
    chapitres = n_distinct(chapitre)
  ) %>% kable()
```


## Statistiques générales

```{r global}
legiplot %>%
  group_by(année,type) %>%
  summarise(nombre = n()) %>%
  ggplot(aes(x=année,y=nombre,fill=type)) +
  geom_col() +
  theme_hc()
```


```{r global.zoom}
legiplot %>%
  filter(année >= 1970) %>%
  group_by(année,type) %>%
  summarise(nombre = n()) %>%
  ggplot(aes(x=année,y=nombre,fill=type)) +
  geom_col() +
  theme_hc()
```


```{r global.code.zoom, fig.width=10, fig.height=8}
legiplot %>%
  filter(année > 1999, code != "code_du_travail") %>%
  group_by(année,code) %>%
  summarise(nombre = n()) %>%
  ggplot(aes(x=année,y=nombre,color=code)) +
  geom_line() +
  facet_wrap(~code) +
  guides(color=FALSE) +
  theme_hc()
```


## Choses à faire

### Comparaison des codes 

- Classement des codes les plus modifiés (absolu)
- Classement des codes les plus modifiés pendant les dernières mandatures (absolu)
- Classement des codes les plus modifiés (relatif au nombre d'articles)
- Classement des codes les plus modifiés pendant les dernières mandatures (relatif au nombre d'articles)

- Classement des articles les plus livres/titres/chapitres les plus modifiés, tous codes confondus (relatif au nombre d'articles)
- Classement des articles les plus modifiés, tous codes confondus

- Classements des plus grosses modifications
- Classements des plus grosses modifications selon une fenêtre glissante

### Pour un code donné

- Evolution du nombre d'articles
- Evolution du nombre d'articles par Livre/Titre/Chapitre
- Visualisation de la taille des sections
- Nombre de modifications dans le temps
- Classement des Livres/Titres/Chapitres/articles les plus modifiés
- Classement des plus grosses modifications
- Classements des plus grosses modifications selon une fenêtre glissante





