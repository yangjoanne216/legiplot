---
title: "code de la propiérité intellectuelle"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggraph)
library(igraph)
library(tidyverse)
```

```{r load}
# create a data frame 
data <- read.csv("test.csv",encoding = "UTF-8")%>%filter(code=="code_du_cinéma_et_de_l'image_animée")
```

```{r transforme}
# transform it to a edge list!
edges_code_partie <- data %>% select(code,partie) %>% unique %>% rename(from=code, to=partie)

edges_partie_sousPartie <- data %>% select(partie,sous_partie) %>% unique %>% rename(from=partie, to=sous_partie)

edges_sousPartie_livre <- data %>% select(sous_partie, livre) %>% unique %>% rename(from=sous_partie,to=livre)

edges_livre_titre <- data %>% select(livre, titre) %>% unique %>% rename(from=livre,to=titre)

edges_titre_chapitre <- data %>% select(titre,chapitre) %>% unique %>% rename(from=titre,to=chapitre)

edges=rbind(edges_code_partie,edges_partie_sousPartie,edges_sousPartie_livre,edges_livre_titre,edges_titre_chapitre)
```

```{r setColor}
vertices = data.frame(
  name = unique(c(as.character(edges$from), as.character(edges$to)))
) 
vertices$group = edges$from[ match( vertices$name, edges$to ) ]
head(vertices)
```

```{r fig.width=30, fig.height=30}
mygraph<- graph_from_data_frame(edges,vertices=vertices) 
ggraph(mygraph, layout = 'dendrogram', circular =TRUE)+geom_edge_diagonal(colour="grey")+scale_edge_colour_distiller(palette = "RdPu") +geom_node_point(aes(colour=group))+geom_node_text(aes(label=name,colour=group))+theme_void()+theme(legend.position="none",plot.margin=unit(c(0,0,0,0),"cm"))

```
